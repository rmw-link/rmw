## 通讯协议

第一个字节 包头 用来标识这是什么命令 ; 其他字节 是数据

第一个字节

CONNECT=1



## 流程

端口探测 ::

  当收到UDP [CONNECT] 的时候，响应一个UDP空包

  这样方便用生日攻击法找到可连端口

首次连接 ::

  首先，生成公钥

  A 发送 :
    
    [

      CONNECT # 1字节
      公钥 
      对后面内容的签名
      服务器IP # 4字节
      服务器端口 #2字节
    ]

  B :
    如果公钥是自己的，不响应
    验证签名 然后响应 : 
      ack 客户端IP 客户端端口

  A: 

    响应 公钥+上面返回客户端IP+端口+随机数
    
    对自己的公钥+客户端IP+客户端端口+随机数签名， 确保blake3后的开头有n个0 

  B: 

    验证 发送 公钥 + blake3(服务器IP+服务器端口+客户端公钥+共享秘钥)
  
  A: 
    
    确认B的公钥，记录
    之后双方就用这个x25519公钥的秘钥来交换信息
    参考代码 https://github.com/rmw-old/cli/blob/master/src/listen.rs

第二次连接

  A: syn 自己的公钥 （公钥+共享秘钥）的hash

  B: 响应通过或者拒绝
  
  如果B拒绝，A开始首次链接的流程

## 字段

IP
  端口 最近一次响应时间 公钥



